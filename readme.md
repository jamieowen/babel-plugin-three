# babel-plugin-three

Babel plugin to convert three examples to ES6 Modules.

**This is not ready yet! 90% there though!**

## Usage

Once the plugin is installed, imports can be carried as usual:
```
import { OrbitControls } from 'three/examples/js/controls/OrbitControls'
import { EffectComposer } from 'three/examples/js/postprocessing/EffectComposer'
```
The plugin will transform the file into ES6, remove the requirement of the THREE global 
but import all internal dependencies using the standard ES6 syntax. i.e.
```
import { Mesh, BoxGeometry, Vector3, Quaternion } from 'three';
```
Example classes have internal dependencies that reference example classes resolved too :
```
import { MaskPass } from 'three/js/examples/postprocessing/MaskPass'
```



## Pull three.js submodule.

After cloning, the three.js submodule needs pulling :
```
git submodule update --recursive --remote
```

## Tests

There are 'pseudo' unit tests that output result of the plugin in to the test/fixtures folder.
The test/update-fixtures.js script copies desired examples scripts from three.js submodule into the fixtures folder.
The list of fixtures is defined in the update-fixtures.js file.

The update fixtures script can be run using :
```
npm run update-fixtures
```

After the plugin output is generated to ClassName.result.js via :
```
npm run test
```

##Â Three Class Index.
A lookup json is required by the plugin that is generated by the scripts/build-three-class-index.js script. 
It essentially runs the plugin against all examples and generates all known local imports & exports and global ( THREE )
imports and exports.  This could be eliminated in a final version and ran on plugin initialisation or package install.

[src/three-class-index.json]

## Demo

WIP on EffectComposer demo as an isolated test.


## Examples Server

This is a brute force method of converting and testing all examples.
```
npm run examples-server
```
This will serve up the regular three.js examples site. But with each request to any example.html file,
it will check the html <script> tags for example files, remove them and then inject a <script> tag pointing
to a js file compiled on the server that includes all depenencies and mutates the THREE global as usual.



## Current Issues / Progress

+ Webpack issues getting some tests going.
+ Some edge cases in module syntax not handling in AST yet.
+ Some internal constants 